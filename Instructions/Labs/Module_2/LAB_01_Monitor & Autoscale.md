---
lab:
    title: '랩 1 - 모니터링 및 자동 크기 조정'
    module: '모듈 2 - 플랫폼 보호 구현'
---

# 모듈 2: 랩 1 - 모니터링 및 자동 크기 조정


Cloud Services, Mobile Services, Virtual Machines 및 웹 사이트의 기본 제공 기능인 자동 크기 조정을 활용하면 수요가 변경되어도 애플리케이션이 최적 성능으로 작동할 수 있습니다. 물론 성능의 의미는 애플리케이션마다 다릅니다. 앱에 따라 CPU, 메모리 등을 기준으로 성능이 결정됩니다. 예를 들어 주간에는 요청 수백만 건을 처리하지만 야간에는 요청을 전혀 처리하지 않는 웹앱이 있는 경우 자동 크기 조정을 통해 위의 기준 중 하나를 사용하거나 사용자가 정의하는 사용자 지정 메트릭을 사용하여 서비스의 크기를 조정할 수 있습니다.


## 연습 1: 랩 설정

1.  PowerShell을 열고 다음 명령을 실행합니다.

     ```powershell
    start "https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FMicrosoftLearning%2FAZ-500-Azure-Security%2Fmaster%2FAllfiles%2FLabs%2FMod2_Lab01%2Ftemplate.json"
     ```

    *그러면 템플릿에서 배포되는 새 앱과 App Service 계획을 사용하여 AZ500 모듈 2 랩 1의 강화 옵션을 시연할 수 있습니다.*

1.  **새 리소스 그룹 만들기** 를 선택합니다.  

1.  **사이트 이름** 및 **서비스 계획** 에 **고유** 한 이름을 입력합니다. 

1.  약관에 동의하고 구매를 클릭합니다.

## 연습 2: 첫 번째 자동 크기 조정 설정 만들기


이제 간단한 단계별 연습을 통해 첫 번째 자동 크기 조정 설정을 만들어 보겠습니다.


1.  Azure Monitor에서 **자동 크기 조정** 블레이드를 열고 크기를 조정할 리소스를 선택합니다. 설정 중에 만든 App Service 계획을 선택할 수 있습니다
1.  현재 인스턴스 수는 1입니다. **자동 크기 조정 사용** 을 클릭합니다.

1.  크기 조정 설정의 이름을 입력하고 **규칙 추가** 를 클릭합니다. 

1.  오른쪽 열리는 컨텍스트 창에 크기 조정 규칙 옵션이 표시됩니다. 기본적으로는 리소스의 CPU 백분율이 70%를 초과하면 인스턴스 수를 1개씩 늘리는 옵션이 설정됩니다. 기본값을 그대로 두고 **추가** 를 클릭합니다.

1.  이제 첫 번째 크기 조정 규칙이 작성되었습니다. UX에 권장 모범 사례와 "하나 이상의 규모 감축 규칙이 있는 것이 좋습니다."라는 메시지가 표시됩니다. 이렇게 하려면 다음 단계를 수행합니다.

    - **규칙 추가** 를 클릭합니다.

    - **연산자** 를 **보다 작음** 으로 설정합니다.

    - **임계값** 을 **20** 으로 설정합니다.

    - **연산** 을 **다음을 기준으로 개수 줄이기** 로 설정합니다.

1.  **추가** 를 클릭합니다.

1.  **저장** 을 클릭합니다.


**축하합니다**! CPU 사용량을 기준으로 웹앱 크기를 자동으로 조정하는 첫 번째 크기 조정 설정을 생성했습니다.


## 연습 3: 일정에 따라 크기 조정


CPU를 기준으로 크기를 조정할 수 있을 뿐 아니라 특정 요일별로 크기를 다르게 조정하도록 설정할 수도 있습니다.


1.  **크기 조건 추가** 를 클릭합니다.

1.  크기 조정 모드와 규칙을 설정하는 과정은 기본 조건과 같습니다.
1.  일정으로 **특정 일 반복** 을 선택합니다.
1.  크기 조정 조건을 적용할 요일과 시작/종료 시간을 선택합니다.


## 연습 4: 특정 날짜별로 다르게 크기 조정


CPU를 기준으로 크기를 조정할 수 있을 뿐 아니라 특정 날짜별로 크기를 다르게 조정하도록 설정할 수도 있습니다.


1.  **크기 조건 추가** 를 클릭합니다.

1.  크기 조정 모드와 규칙을 설정하는 과정은 기본 조건과 같습니다.
1.  일정으로 **시작/종료 날짜 지정** 을 선택합니다.
1.  크기 조정 조건을 적용할 시작/종료 날짜와 시작/종료 시간을 선택합니다.



## 연습 5:  리소스의 크기 조정 기록 확인

1.  리소스를 강화하거나 규모 축소할 때마다 활동 로그에 이벤트가 기록됩니다. **실행 기록** 탭으로 전환하면 지난 24시간 동안의 리소스 크기 조정 기록을 확인할 수 있습니다.

1.  전체 크기 조정 기록(최대 90일)을 확인하려면 **자세한 내용을 보려면 여기를 클릭하세요.** 를 선택합니다. 그러면 리소스와 범주로 자동 크기 조정이 미리 선택된 활동 로그가 열립니다.

## 연습 6: 리소스의 크기 조정 정의 확인

1.  자동 크기 조정은 Azure Resource Manager 리소스입니다. **JSON** 탭으로 전환하면 JSON 형식의 크기 조정 정의를 확인할 수 있습니다.

1.  필요한 경우 **JSON** 을 직접 변경할 수 있습니다. 이러한 변경 내용은 저장하고 나면 반영됩니다.


| 경고: 계속하기 전에 이 랩에서 사용한 모든 리소스를 제거해야 합니다.  **Azure Portal** 에서 리소스를 제거하려면 **리소스 그룹** 을 클릭합니다.  랩에서 만든 리소스 그룹을 모두 선택합니다.  리소스 그룹 블레이드에서 **리소스 그룹 삭제** 를 클릭하고 리소스 그룹 이름을 입력한 다음 **삭제** 를 클릭합니다.  추가로 만든 리소스 그룹이 있으면 이 프로세스를 반복합니다. **리소스 그룹을 삭제하지 않으면 다른 랩에서 문제가 발생할 수 있습니다.** |
| --- |


**결과**: 이 랩이 완료되었습니다.
