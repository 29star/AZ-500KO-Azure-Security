

# 모듈 4: 데이터베이스 감사

## 연습 1: 데이터베이스에서 감사를 사용하도록 설정

### 태스크 1: 랩 설정

1.  **PowerShell** 을 열고 다음 명령을 실행하여 랩용 데이터베이스를 배포합니다.

     ```powershell
    start "https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FMicrosoftLearning%2FAZ-500-Azure-Security%2Fmaster%2FAllfiles%2FLabs%2FMod4_Lab02%2Fazuredeploy.json" 
     ```

1.  **리소스 그룹** 아래에서 새로 만들기를 선택하고 기본 이름인 "**Mod4Lab2**"를 사용하여 리소스 그룹을 만듭니다.

1.  입력되어 있는 기본 SQL Server 이름을 사용해도 됩니다.

1.  **구매** 를 클릭합니다.
경고
**참고**: 테스트 데이터가 포함된 SQL 데이터베이스가 배포될 때까지 기다려야 합니다.

### 태스크 2: 데이터베이스에서 감사를 사용하도록 설정

1.  랩 설정에서 만든 리소스 그룹을 선택합니다.

2.  **SQL 서버** **az500labserver2** 를 선택합니다.

3.  **보안** 에서 **감사** 를 선택합니다.

4.  **감사** 를 **설정** 으로 전환합니다.

5.  감사 로그를 전송할 위치로 스토리지를 선택합니다.

6.  **구성을 클릭합니다.**

7.  사용자의 **구독** 을 선택합니다.

8.  **새로 만들기** 를 클릭합니다.

9.  구독 이름을 "**mod4lab2YOURNAME**" 형식으로 고유하게 지정합니다.

10. **확인** 을 클릭합니다.

11. 보존 기간(일)을 **5** 로 변경하고 **확인** 을 클릭합니다. 

12. **저장** 을 클릭하여 **감사 구성** 을 저장합니다.

## 연습 2: 감사 로그 검토

### 태스크 1: SQL DB에서 감사 로그를 검토합니다.

1.  데이터베이스의 감사 로그를 검토하려면 랩 설정에서 만든 리소스 그룹으로 돌아옵니다.

1.  **AZ500LabDb(az500labserver2/AZ500LabDb)** 를 클릭하여 테스트 데이터베이스를 선택합니다.

1.  **감사** 를 클릭합니다.
경고
**참고**: 여기서는 감사가 해제되어 있는 것으로 표시되지만 기본 서버 수준에서는 설정되어 있으므로 이 데이터베이스에 대해서도 설정되어 있습니다.


1.  **감사 로그 보기** 를 **클릭합니다**.
경고
**참고**: 여기서 SQL 삽입 시도를 포함한 DB의 감사 로그 출력을 검토합니다. 이 데이터베이스는 최근에 만든 테스트 데이터베이스이므로, 현재는 로그에 감사할 내용(있는 경우)이 최소한으로만 포함되어 있습니다.
서버 감사를 사용하도록 설정하면 데이터베이스에서 구성한 감사가 서버 감사와 함께 사용됩니다.
Azure 스토리지 계정, Log Analytics 작업 영역(Azure Monitor 로그에 사용하려는 경우) 또는 이벤트 허브(이벤트 허브를 통해 로그를 사용하려는 경우)에 감사 로그를 작성하도록 선택할 수 있습니다. 이러한 옵션을 적절하게 조합하여 구성할 수 있으며, 그러면 감사 로그가 각 위치에 작성됩니다.



**결과**: SQL 데이터베이스에 대해 감사를 설정했으며 감사 출력을 확인할 위치를 검토했습니다.
